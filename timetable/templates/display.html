{% load static %}
{% load i18n %}
<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Display</title>
		<link rel="stylesheet" href="{% static "style.css" %}">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
		<style>
		body, html {
			height: 100%;
			overflow: hidden;
		}
		</style>
	</head>
	<body style="overflow-y: hidden;">
		<header class="display-header">
			<nav class="navbar">
				<h1 class="logo-wrapper">
					<a class="site-logo" href="{% url "home" %}" title="{% trans "Visit the main page" %}">
						<img src="{% static "zorza_text.svg" %}" alt="Zorza">
					</a>
				</h1>
				<div class="display-timer">
					{% include "timer.html" %}
				</div>
				<div class="display-datetime">
					{% now "l" %}, {% now "n E" %}
					<span id="display-time">
						12:12:12
					</span>
				</div>
			</nav>
		</header>
		<main class="container display">
			<p class="text-center">
				{% include "dayplans.html" %}
			</p>
			{% include "substitutions.html" %}
			{% include "absences.html" %}
			{% include "reservations.html" %}
		</main>
		<script id="todays-periods">
			todays_periods = {% autoescape off %}{{ todays_periods_json }}{% endautoescape %};
			server_utc_offset = {{ utc_offset }};
		</script>
		<script src="{% static "timetable.js" %}"></script>
		<script>
			setInterval(function () {
				var clock = document.getElementById("display-time");
				// TODO: show server time
				var time = new Date();
				clock.textContent = time.toLocaleTimeString();
			}, 100);

			//scroll
			var substitutions = document.getElementsByClassName("substitutions")[0];
			var main = document.getElementsByTagName("header")[0];
			var i = 0;
			var n = substitutions.children.length;
			scrollOptions = { behavior: 'smooth', block: 'start' };
			function scrollNext() {
				if (i < n) {
					substitutions.children[i].scrollIntoView(scrollOptions)
					i++;
				} else {
					// show top of main
					main.scrollIntoView(scrollOptions);
					i = 0;
				}
				setTimeout(scrollNext, 2500);
			}
			scrollNext();
		</script>
	</body>
</html>
